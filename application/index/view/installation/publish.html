<!--nav-->
{include file="public/header" }
<style>
    .btn-numbox {
        margin-top: 0px;
    }

    .btn-numbox li {
        float: left;
    }

    .btn-numbox li .number,
    .kucun {
        display: inline-block;
        font-size: 12px;
        color: #808080;
        vertical-align: sub;
    }

    .btn-numbox .count {
        overflow: hidden;
        margin: 0 16px 0 -20px;
    }

    .btn-numbox .count .num-jian,
    .input-num,
    .num-jia {
        display: inline-block;
        width: 28px;
        height: 32px;
        line-height: 28px;
        text-align: center;
        font-size: 18px;
        color: #999;
        cursor: pointer;
        border: 1px solid #e6e6e6;
    }

    .btn-numbox .count .num-jia {
        margin-left: 1px;
    }

    .btn-numbox .count .input-num {
        width: 58px;
        height: 32px;
        color: #333;
        border-left: 0;
        border-right: 0;

    }
    label{
        font-size: 10px;
    }
</style>
<link rel="stylesheet" type="text/css" href="__PUBLIC__static/admin/webupload/webuploader.css">
<link rel="stylesheet" type="text/css" href="__PUBLIC__static/admin/webupload/style.css">
<link href="__PUBLIC__static/index/css/select2.css" rel="stylesheet" />
<script src="__PUBLIC__static/index/js/select2.js"></script>
<style>
    .file-item{float: left; position: relative; width: 110px;height: 110px; margin: 0 20px 20px 0; }
    .file-item .info{overflow: hidden;}
    .uploader-list{width: 100%; overflow: hidden;}
    #imgPickers .webuploader-pick{
        background: #fff;
    }
    .dele1>div{
        padding-left: 10px;
        padding-right: 10px;
    }
</style>
<form id="demoa"  method="post" action="__PUBLIC__installation/placeorder" class="demoform">
    <input id="ds-sub" name="ds_step" hidden="hidden" value="">
    <div class="main install_order_details">
        <!--/*主题*/-->
        <div class="container">
            <h5 class="page-header">
                <span class=pl-10>当前位置：</span>
                <small>安装下单</small>
                <span>>></span>
            </h5>
            <!--/*标题*/-->
            <div class="The-test-panel-head">
                <div class="pl-20">
                    安装下单
                </div>
            </div>
            <div class="The-test-panel-body pl-0">
                <div class="dele1" style="line-height: 40px">
                    <!--判断是否登录-->
                    <?php if(empty($_SESSION['think']['ds_username'])){ ?>
                    <div class="row" >
                        <input type="hidden" id="denglu" >
                        <label style="float:left;" class="pl-20">您还未登录,登录后给您更好的服务</label>
                        <div class="col-sm-6"><a href="__PUBLIC__auth" class="text-orange">登录>></a></div>
                    </div>
                    <!--一条线-->
                    <div class="border-bottom-1 ml-0 mb-10"></div>
                    <?php } ?>
                    <div class="row mt-10">
                        <!-- 登入后的状态 -->
                        <?php if(!empty($_SESSION['think']['ds_username'])): ?>
                        <div class="col-md-6">
                            <div class="row">
                                <label class="col-md-3 col-xs-12">客户ID</label>
                                <div class="col-md-8 col-xs-10"><input type="text" readonly unselectable="on" id="client" name="uid" class="form-control ds-uid" value="<?php echo $_SESSION['think']['id'] ?>">
                                    <input type="text" style="display:none" id="uname" name="uname" class="form-control ds-uid" value="<?php echo $_SESSION['think']['ds_username'] ?>">
                                </div>

                            </div>
                        </div>
                        <?php endif; ?>
                        <div class="col-md-6">
                            <div class=" row">
                                <label class="col-md-3 col-xs-12" name="market_cer">商城名称</label>
                                <div class="col-md-8 col-xs-10">
                                    <input type="text" autocomplete="off" name="installation[designation]" id="designation" class="form-control">
                                </div>
                                <label class="col-xs-1"><b class='text-orange xin'>*</b></label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <!--联系人-->
                        <div class="col-md-6">
                            <div class="row">
                                <label class="col-md-3 col-xs-12">联系人</label>
                                <div class="col-md-8 col-xs-10">
                                    <input type="text" autocomplete="off" name="installation[contact_name]" lay-verify="linkman_contacts|required"  id="linkman_contacts" class="form-control" value="{$loaction.name}">
                                </div>
                                <label class="col-xs-1"><b class='text-orange xin'>*</b></label>
                            </div>

                        </div>
                        <!--预约开始时间-->
                        <div class="col-md-6">
                            <div class="row">
                                <label for="input_date" class="col-md-3 col-xs-12">预约开始时间</label>
                                <div class="col-md-8 col-xs-10">
                                    <div class="input-append date form_datetime" id="input_date"   data-date="2013-02-21T15:25:00Z">
                                        <input class="layui-input" autocomplete="off" id="form_datetime" class="form-control" placeholder="" name="installation[start_at]" onclick="layui.laydate({elem: this, format:'YYYY-MM-DD hh:mm:ss',istime: true,min: laydate.now()})">

                                    </div>

                                </div>
                                <label class="col-xs-1"><b class='text-orange xin'>*</b></label>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <!--联系电话-->
                        <div class="col-md-6 ">
                            <div class="row">
                                <label class="col-md-3  col-xs-12">联系人电话</label>
                                <div class="col-md-8 col-xs-10">
                                    <input type="text" autocomplete="off" name="installation[contact_phone]" lay-verify="phone|required" id="telephone"  class="form-control" value="{$loaction.phone}">
                                </div>
                                <label class="col-xs-1"><b class='text-orange xin'>*</b></label>
                            </div>
                        </div>

                        <!--目标维修地址-->
                        <?php if($loaction['province']==''):?>
                        <div class="col-xs-12 col-md-6">
                            <div class="row">
                                <label class="col-md-3 col-xs-12 mt-10">目标安装地址 </label>
                                <div class="col-md-8 col-xs-11">
                                    <div id="distpicker5" class="row">
                                        <div class="col-md-4 mb-10 col-xs-12">
                                            <select lay-filter="location_ext"  name="installation[location_ext]" class="form-control" lay-verify="" id="province10">

                                            </select>
                                            <input type='hidden' value="" name="m">
                                        </div>
                                        <div class="col-md-4 mb-10 col-xs-12">

                                            <select lay-filter="location_ext1" name="installation[location_exta]" class="form-control" lay-verify="" id="district10">

                                            </select>
                                            <input type='hidden' value="" name="b">
                                        </div>
                                        <div class="col-md-4  mb-10 col-xs-12">
                                            <select lay-filter="location_ext2" name="installation[location_extb]" class="form-control" lay-verify="" id="city10" >

                                            </select>
                                            <input type='hidden' value="" name="c">
                                        </div>
                                    </div>
                                </div>
                                <label class="col-xs-1"><b class='text-orange xin'>*</b></label>
                            </div>
                        </div>
                        <?php else:?>
                        <div class="col-md-6">
                            <div class="row">
                                <label class="col-md-3 col-xs-12">目标安装地址</label>
                                <div class="col-md-8 col-xs-10">
                                    <div class="row" >
                                        <div class="col-md-12">
                                            <input type="hidden"  style="border:none;background:#fff"  class='form-control' name="installation[location_ext]" id="province10" value="{$loaction.province}">
                                            <input type="hidden" style="border:none;background:#fff"  class='form-control' name="installation[location_exta]" id="district10" value="{$loaction.district}">
                                            <input type="hidden" style="border:none;background:#fff"   class='form-control' name="installation[location_extb]" id="city10" value="{$loaction.city}">
                                            <span id="ds_u_pro">{$loaction.province}</span>
                                            <span id="ds_u_cit">{$loaction.city}</span>
                                            <span id="ds_u_dis">{$loaction.district}</span>
                                            <span id="ds_u_ars">{$loaction.location}</span>
                                            <a class="ds_add_dizhi" style="cursor: pointer;">使用新地址</a>
                                        </div>

                                    </div>
                                </div>
                                <label class="col-xs-1"><b class='text-orange xin'>*</b></label>
                            </div>
                        </div>
                        <?php endif;?>
                    </div>
                    <div class="row">
                        <!--品牌-->
                        <div class="col-sm-6">

                        </div>
                        <?php if($loaction['province']==''):?>
                        <div class="col-sm-6">
                            <div class="row">
                                <label for="input_date" class="col-sm-3 col-xs-5"></label>
                                <div class="col-sm-8 col-xs-12">
                                    <div class="input-append date form_datetime" id=""   data-date="2013-02-21T15:25:00Z">
                                        <input type="text" autocomplete="off" name="installation[location_extc]" lay-verify="province4|required" id="province4" placeholder="请输入详细地址，精确到街道、门牌号" class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <?php else:?>
                        <div class="col-sm-6">
                            <div class="row">
                                <label for="input_date" class="col-sm-3 col-xs-5"></label>
                                <div class="col-sm-8 col-xs-7">
                                    <div class="input-append date form_datetime" id=""   data-date="2013-02-21T15:25:00Z">
                                        <input type="hidden" autocomplete="off" name="installation[location_extc]" lay-verify="province4|required" id="province4" value="{$loaction.location}" class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <?php endif;?>
                    </div>
                    <div class="border-bottom-1 mt-20 ml-0 mb-20"></div>

                    <div class="row">
                        <!--服务类别-->
                        <div class="col-md-6">
                            <div class="row">
                                <label class="col-md-3 col-xs-12">服务类别</label>
                                <div class="col-md-8 col-xs-10">
                                    <input type="text" autocomplete="off" id="maintain" name=""  disabled  class="form-control" value="安装">
                                </div>
                            </div>
                        </div>
                        <!--服务大类-->
                        <div class="col-md-6">
                            <div class="row">
                                <label class="col-md-3 col-xs-12">商品大类</label>
                                <div class="col-md-8 col-xs-10">
                                    <select  pane class="form-control layui-form-pane"  name="installation[category]" lay-filter="product_categories" lay-verify="product_categories" id="product_categories" lai-ignore  id="product_categories">
                                        {foreach name="categories" item="category"}
                                        <option value="{$category.id}">{$category.name}</option> {/foreach}
                                    </select>
                                </div>
                                <label class="col-xs-1"><b class='text-orange xin'>*</b></label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="row">
                                <label class="col-md-3 col-xs-12">服务小类 </label>
                                <div class="col-md-8 col-xs-10">
                                    <select class="form-control" lay-filter="product_categories1"   lay-verify="product_categories1" lai-ignore name="installation[commodity]" id="product_categories1">{foreach name="commodities" item="commodity"}
                                        <option value="{$commodity.id}">{$commodity.name}</option> {/foreach}
                                    </select>
                                </div>
                                <label class="col-xs-1"><b class='text-orange xin'>*</b></label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="row">
                                <label class="col-md-3 col-xs-12">品牌 </label>
                                <div class="col-md-8 col-xs-10">
                                    <select lay-filte="brand"  lay-verify="brand|required" name="installation[brand]"id="brand" autocomplete="off" class="form-control js-example-tags">
                                        {volist name="brand" id="v"}
                                        <option value="{$v.brand}">{$v.brand}</option>
                                        {/volist}
                                    </select>
                                </div>
                                <label class="col-xs-1"><b class='text-orange xin'>*</b></label>
                            </div>
                        </div>
                    </div>

                    <div class="border-bottom-1 mt-20 mb-20"></div>
                    <div class="row" style="line-height: 16px">
                        <div class="col-md-2 col-xs-12 mb-10">
                            <div class="checkbox checkbox-success">
                                <input type="checkbox" name="installation[pre_trans]" id="pre_trans" lay-filter="forward_delivery" lay-skin="primary"  value="" title="需先行发货">
                                <label for="pre_trans" >需先行发货</label>
                            </div>
                        </div>
                        <div class="col-md-10 hidden col-xs-12">
                            <div class="row">
                                <label class="col-md-2 col-xs-4 mt-10" for="">提货地址 <b class='text-orange xin'>*</b></label>
                                <div class="col-md-10 col-xs-12">
                                    <div id="distpicker4" class="row">
                                        <div class="form-group col-md-3 col-xs-12">
                                            <label class="sr-only" for="province"></label>
                                            <select  disabled class="form-control"  id="province" name="installation[trans_address]" lay-verify="province" lay-filter="province" name="province">

                                            </select>
                                        </div>
                                        <div class="form-group col-md-3 col-xs-12">
                                            <label class="sr-only" for="city"></label>
                                            <select disabled  class="form-control" lay-filter="city" lay-verify="city" id="city" name="installation[trans_addressb]">

                                            </select>
                                        </div>
                                        <div class="form-group col-md-3 col-xs-12">
                                            <label class="sr-only" for="district"></label>
                                            <select disabled name="installation[trans_addressa]"  class="form-control" lay-filter="district" lay-verify="district" id="district">

                                            </select>
                                        </div>
                                        <div class="form-group col-md-3 col-xs-12">
                                            <input type="text" disabled autocomplete="off" name="installation[trans_addressc]" class="form-control"  lay-verify="dizhi" id="dizhi" lay-filter="dizhi"   placeholder="请详细填写提货地址">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row " style="line-height: 16px">
                        <div class="col-sm-2">
                            <div class="checkbox checkbox-success">
                                <input type="checkbox" name="installation[pre_survey]"  id="pre_survey" lay-skin="primary" lay-verify="pre_survey" lay-filter="pre_survey" value="" title="是否有前置勘测单">
                                <label for="pre_survey">是否有前置勘测单</label>
                            </div>

                        </div>
                        <div class="col-sm-10 hidden mb-10">
                            <div class="row">
                                <label class="col-sm-2 col-xs-3 mt-10" for="">勘测单号 <b class='text-orange xin'>*</b></label>
                                <div class="col-xs-8">
                                    <input type="text" disabled id="there_is_a_pre_survey"  lay-verify="there_is_a_pre_survey" lay-filter="there_is_a_pre_survey"  name="installation[pre_survey_num]" class="form-control">
                                </div>

                            </div>

                        </div>
                    </div>
                </div>

                <div class="border-bottom-1"></div>

                <div class="row k pl-20 pt-10">
                    <div class="col-md-3 mt-10 col-xs-12 col-sm-4">
                        物流提货 <b class='text-orange xin'>*</b>
                    </div>
                    <input type="hidden" lay-verify="lse" id="lse" name="installation[special_delivery]" value="">
                    <div class="col-md-2 col-xs-6 col-sm-4">
                        <div class="radio radio-success">
                            <input type="radio" lay-filter="carload_freight" value="1" id="less-l-carload_freight" name="special_delivery" title="零担">
                            <label for="less-l-carload_freight">
                                零担
                            </label>
                        </div>
                    </div>
                    <div class="col-md-2 col-xs-6 col-sm-4">
                        <div class="radio radio-success">
                            <input type="radio" name="special_delivery" lay-filter="Special_delivery" value="0" id="Special_delivery" title="专车发货">
                            <label for="Special_delivery">
                                专车发货
                            </label>
                        </div>

                    </div>
                </div>

                <div class="border-bottom-1"></div>

                <div class="row k pl-20 pt-10">
                    <div class="col-md-3 col-xs-12 mt-10 col-sm-4">
                        是否需要师傅自带板车 <b class='text-orange xin'>*</b>
                    </div>
                    <input type="hidden" lay-verify="sse" id="sse" name="installation[self_car]" value="">
                    <div class="col-md-2 col-xs-6 col-sm-4">
                        <div class="radio radio-success">
                            <input id="s_shi" name="self_car" lay-filter="s_shi" value="1"  type="radio" title="是">
                            <label for="s_shi">是</label>
                        </div>
                    </div>
                    <div class="col-md-2 col-xs-6 col-sm-4">
                        <div class="radio radio-success">
                            <input id="s_fou" name="self_car" lay-filter="s_fou" value="0" type="radio" title="否">
                            <label for="s_fou">否</label>
                        </div>
                    </div>
                </div>

                <div class="border-bottom-1"></div>

                <div class="row k pl-20 pt-10">
                    <div class="col-md-3 col-xs-12 mt-10 col-sm-4">
                        是否需要师傅
                        代缴工程押金 <b class='text-orange xin'>*</b>
                    </div>
                    <input type="hidden" lay-verify="yse" id="yse" name="installation[self_deposit]" value="">
                    <div class="col-md-2 col-xs-6 col-sm-4">
                        <div class="radio radio-success">
                            <input name="self_deposit" id="y_shi" lay-filter="y_shi" value="1" type="radio" title="是">
                            <label for="y_shi">
                                是
                            </label>
                        </div>
                    </div>
                    <div class="col-md-2 col-xs-6 col-sm-4">
                        <div class="radio radio-success">
                            <input name="self_deposit" id="y_fou" type="radio"  value="0" lay-filter="y_fou" title="否">
                            <label for="y_fou">
                                否
                            </label>
                        </div>
                    </div>
                </div>
                <div class="border-bottom-1 mt-10"></div>

                <div class="row k pl-20 pt-10 ">
                    <div class="col-md-3 col-xs-12 mt-10 col-sm-4">
                        安装模式 <b class='text-orange xin'>*</b>
                    </div>
                    <div class="col-md-2  col-xs-6 col-sm-4">
                        <div class="radio radio-success">
                            <input type="radio" name="assistance_mode" lay-filter="Turnkey_mode" value="1"  title="全包模式" id="Turnkey_mode">
                            <label for="Turnkey_mode">全包模式</label>
                        </div>
                    </div>
                    <input type="hidden" lay-verify="ase" id="ase" name="installation[assistance_mode]" value="">
                    <div class="col-md-2 col-xs-6 col-sm-4">
                        <div class="radio radio-success">
                            <input type="radio" name="assistance_mode" lay-filter="assistance_mode" value="0" id="assistance_mode" title="协助模式">
                            <label for="assistance_mode">
                                协助模式
                            </label>
                        </div>
                    </div>
                </div>
                <div class="row  B" style="background: #F4F4F4;margin: 0;display: none">
                    <div class="col-md-2 pl-30  col-xs-12 mt-90_sm mt-30_s col-sm-2 ">
                        安装人员 <b class='text-orange xin'>*</b>
                    </div>
                    <div class="col-sm-10 col-xs-12 line-height-30">
                        <div class="row mt-20 mb-20">
                            <div class="col-sm-4 col-xs-12">
                                <label class="col-md-4 mt-10"  for="woodworking">
                                    木工 <b class='text-orange xin'>*</b>
                                </label>
                                <div class="col-md-8">
                                    <input class="form-control" disabled autocomplete="off" lay-verify="woodworking" name="installation[woodworking]" id="woodworking" placeholder="位" type="text">
                                </div>
                            </div>
                            <div class="col-sm-4 col-xs-12">
                                <label class="col-md-4 mt-10" for="electrician">
                                    电工 <b class='text-orange xin'>*</b>
                                </label>
                                <div class="col-md-8">
                                    <input class="form-control" disabled autocomplete="off" lay-verify="electrician" id="electrician" name="installation[electrician]" placeholder="位" type="text">
                                </div>
                            </div>
                            <div class="col-sm-4 col-xs-12">
                                <label class="col-md-4 mt-10" for="brick_layer">
                                    瓦工 <b class='text-orange xin'>*</b>
                                </label>
                                <div class="col-md-8">
                                    <input class="form-control" disabled autocomplete="off" lay-verify="brick_layer" name="installation[brick_layer]" id="brick_layer" placeholder="位" type="text">
                                </div>
                            </div>
                            <div class="col-sm-4 col-xs-12">
                                <label class="col-md-4 mt-10" for="Oiler">
                                    油工 <b class='text-orange xin'>*</b>
                                </label>
                                <div class="col-md-8">
                                    <input class="form-control" disabled autocomplete="off" lay-verify="Oiler"  id="Oiler" name="installation[oiler]" placeholder="位" type="text" >
                                </div>
                            </div>
                            <div class="col-sm-4 col-xs-12">
                                <label class="col-md-4 mt-10" for="hamal">
                                    搬运工<b class='text-orange xin'>*</b>
                                </label>
                                <div class="col-md-8">											<input autocomplete="off" class="form-control" name="installation[hamal]" disabled lay-verify="hamal"  id="hamal" placeholder="位" type="text">
                                </div>
                            </div>
                            <div class="col-sm-4 col-xs-12">
                                <label class="col-md-4 mt-10" for="reslt">
                                    其他<b class='text-orange xin'>*</b>
                                </label>
                                <div class="col-md-8">											<input autocomplete="off" class="form-control" name="installation[reslt]" disabled lay-verify="reslt"  id="reslt" placeholder="位" type="text">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="border-bottom-1"></div>

                <div class="row pl-20 upload_module">
                    <div class="col-sm-6 col-xs-12">
                        <div class="row">
                            <div class="col-sm-4 col-xs-12">
                                安装进度计划表(图)
                            </div>
                            <input type="hidden" lay-verify="Up" value="" name="installation[Up]" id="Up" lay-filter="Up">
                            <div class="col-sm-4 col-xs-12">
                                <!--<input type="file" name="images[]" lay-type="file" lay-type="" value="" id="aaka" class="layui-upload-file">-->
                                <a href= "javascript:; "num="1" class="text-blue" id="">上传计划表图</a>
                            </div>
                            <div class="col-sm-4 col-xs-12">
                                <a href= "javascript:; "num="0" class="text-blue" id="There_is_no_schedule">无计划表图</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xs-12">
                        <div class="row">
                            <div class="col-xs-12 col-sm-4">
                                安装图纸(图)
                            </div>
                            <input type="hidden" value="" lay-verify="drawings" name="installation[drawings]" id="drawings" lay-filter="drawings">
                            <div class="col-xs-12 col-sm-4">
                                <a href= "javascript:;" num="1" class="text-blue">上传图纸图</a>
                            </div>
                            <div class="col-xs-12 col-sm-4">
                                <a href= "javascript:;" num="0" class="text-blue">无图纸图</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 col-xs-12">
                        <div class="row">
                            <div class="col-xs-12 col-sm-4">
                                安装验收单(图)
                            </div>
                            <input type="hidden" autocomplete="off" value="" lay-verify="check_list" name="installation[check_list]" id="check_list" lay-filter="check_list">
                            <div class="col-xs-12 col-sm-4">

                                <a href= "javascript:;" num="1" class=" text-blue">上传验收单图</a>
                            </div>
                            <div class="col-xs-12 col-sm-4">
                                <a href= "javascript:;" num="0" class=" text-blue">无验收单图</a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="border-bottom-1 mb-10 "></div>
                <div class="row k  pl-20 Increase_the_project_titlemb-10">
                    <div class="col-md-3 mt-10 col-xs-12 col-sm-4">
                        完工后垃圾处理方式 <b class='text-orange xin'>*</b>
                    </div>
                    <input type="hidden" lay-verify="cse" id="cse" name="installation[self_trash]" value="">
                    <div class="col-md-2 col-xs-12 col-sm-4">
                        <div class="radio radio-success" style="margin-left:5%">
                            <input name="self_trash" id="c_shi" lay-filter="c_shi" checked value="1" type="radio" title="商场处理">
                            <label for="c_shi">
                                商场处理
                            </label>
                        </div>
                    </div>
                    <div class="col-md-2 col-xs-12 col-sm-4">
                        <div class="radio radio-success">
                            <input name="self_trash" id="c_fou" type="radio" value="0" lay-filter="c_fou" title="师傅处理">
                            <label for="c_fou">
                                师傅处理
                            </label>
                        </div>
                    </div>
                </div>
                <div class="row pl-20 mr-0 ml-0" style="background: #FCE8D8;">
                    <!--商场办证-->
                    <div class="col-md-3 mt-10  col-xs-12">
                        商场办证 <b class='text-orange xin'>*</b>
                    </div>
                    <div class="col-md-2  col-xs-12">
                        <div class="radio radio-success">
                            <input value="1" type="radio" id="master_worker"  name="installation[departure_card]" title="师傅代办" checked name="departure_card">
                            <label for="master_worker">
                                师傅代办
                            </label>
                        </div>


                    </div>
                    <div class="col-md-2  col-xs-12">
                        <div class="radio radio-success">
                            <input value="2" type="radio" id="clientele" name="installation[departure_card]" title="客户办理" name="departure_card">
                            <label for="clientele">
                                客户办理
                            </label>
                        </div>
                    </div>
                    <div class="col-md-2  col-xs-12">
                        <div class="radio radio-success">
                            <input value="3" type="radio" id="do_without" name="installation[departure_card]" title="不需要办证" name="departure_card">
                            <label for="do_without">
                                不需要办证
                            </label>
                        </div>
                    </div>
                </div>
                <div class="border-bottom-1 mt-10 mb-20"></div>



                <div class="row">
                    <div class="col-md-2 pl-30 " >
                        <label class="btn btn-default">门头照片</label>
                    </div>
                    <div class="col-xs-12 col-md-3">
                        <div id="imgPickers">
                            <img id="img_datas"  class="mt-0_xs" style="width: 200px;height: 200px" src="__PUBLIC__static/index/images/tj.png"/>
                            <input type="hidden" id="data_photos" name="storefront">
                        </div>
                    </div>
                </div>

                <div class="border-bottom-1"></div>
                <!--需求-->
                <div class="row pl-20 pb-10">
                    <div class="col-md-12 ">
                        <div class="checkbox-warning checkbox">
                            <input type="checkbox"  value="1"   id="nuclear_list_in_advance">
                            <label for="nuclear_list_in_advance">需现场调查，进一步核实</label>
                        </div>
                    </div>
                    <div class="col-md-3 ">
                        <div class="checkbox checkbox-primary">
                            <input type="checkbox"  id="ds-s"    value="1" >
                            <label for="ds-s">使用平台月结服务</label>
                        </div>
                        <input type="password" autocomplete="off"  name="pwd" placeholder="月结客户使用的密码" id="year_service_ordere_pwd" class="form-control" style="opacity: 0">
                    </div>
                </div>

                <div class="border-bottom-1"></div>

                <div class="row pl-20 pt-20 pb-10">
                    <div class="col-sm-3" style="color: red;">
                        注： <b class='text-orange xin'>*</b> 表示必填项
                    </div>
                </div>


            </div>
            <div class="row">
                <div class="col-md-12 mt-20">
                    <a id="yezhuxieyi" href="javascript:;" class="" id="yz">《业主协议》</a>
                    <div class="mt-10 checkbox checkbox-success" style="display: inline-block">
                        <input type="checkbox" id="agreement">
                        <label for="agreement">我同意协议</label>
                    </div>
                </div>
            </div>
            <div class="row pb-20 pl-10">
                <div class="col-md-3 col-sm-4 col-xs-6 col-sm-offset-1 text-center mt-20">
                    <button id="xiandan" lay-submit="" lay-filter="demo1" class="btn bg-success disabled form-control border-radius ">直接下单</button>
                </div>
                <input type="hidden" id="step_type" value="" name="step_type">
                <div class="col-md-3 col-md-offset-4  col-sm-4 col-xs-6 text-center mt-20">
                    <input type="submit"  id="quick_consulting" class="btn btn-blue form-control disabled border-radius " value="快捷咨询">
                </div>
            </div>
            <input id="judge" name="judge" hidden="hidden" value="">
            <input value="0" id="ds_hedan" name="hedan" hidden="hidden">
            <?php if(empty($_SESSION['think']['type'])) :?>
            <?php else: ?>
            <input value="<?php echo $_SESSION['think']['type']; ?>" id="ds_worker_type" name="ds_worker_type" hidden>
            <?php endif ?>
        </div>
    </div>
</form>
<script type="text/javascript" src="__PUBLIC__static/admin/webupload/webuploader.min.js"></script>
<script src="__CITY__/distpicker.data.js"></script>
<script src="__CITY__/distpicker.js"></script>
<script src="__CITY__/main.js"></script>
{include file="public/footer" }
<div id="de" style="opacity: 1;position: absolute;top:  10px;height: 0;overflow: hidden" class="">
    <div id="imgPicker" class="mb-10 ml-20 mt-20">
        <i class="glyphicon glyphicon-plus"></i>上传计划表图
    </div>
</div>
<div id="de1"  style="opacity: 1;position: absolute;top:  10px;height: 0;overflow: hidden" class="">

    <div id="imgPicker1" class="mb-10 ml-20 mt-20">
        <i class="glyphicon glyphicon-plus"></i>上传图纸图
    </div>
</div>
<div id="de2" style="opacity: 1;position: absolute;top:10px;height: 0;overflow: hidden" class="">

    <div id="imgPicker2" class="mb-10 ml-20 mt-20">
        <i class="glyphicon glyphicon-plus"></i>上传验收单图
    </div>
</div>
<script>

</script>
<script type="text/javascript">

</script>
<script>
    $(function () {
        function ds_show(){
            $.get("__PUBLIC__api_uid_address", function(data) {
                $('#linkman_contacts').val(data.name);
                $('#telephone').val(data.phone);
                $('#province10').val(data.province);
                $('#city10').val(data.city);
                $('#district10').val(data.district);
                $('#address').val(data.location);
                $('#ds_u_pro').html(data.province);
                $('#ds_u_cit').html(data.city);
                $('#ds_u_dis').html(data.district);
                $('#ds_u_ars').html(data.location);
            }, "json" );
        }
        $(".ds_add_dizhi").click(function () {
            var uid=$('#ds_uid').val();
            var layer=layui.layer;
            var  url="__PUBLIC__/client_location";
            parent.layer.open({
                type:2,
               area:["800px","650px"],
                offset:'100px',
                title:" ",
                shade:0,
                content: ['__PUBLIC__/client_location', 'no'],
                scrollbar:false,
                end: function() {
                    ds_show();
                },
                success:function (inde) {
                }
            });
        });
       
       
        $(document).ready(function() {

            $('#demoa').ajaxForm({
                beforeSubmit:checkForm,
                success: complete, // 这是提交后的方法
                dataType: 'json'

            });
            function checkForm() {
                var ds_types=$("#ds_worker_type").val();
                if(ds_types==2){
                    msg('您是师傅,不能下单',2);
                    return false;
                }
                if ('' == $.trim($('#designation').val())) {
                Tip("designation","请填写商城名称");
                return false;
            }
            if ('' == $.trim($('#linkman_contacts').val())) {
                Tip("linkman_contacts","请填写联系人");
                return false;
            }
            if ('' == $.trim($('#form_datetime').val())) {
                Tip("form_datetime","请填写预约开始时间");
                return false;
            }
            if ('' == $.trim($('#telephone').val())) {
                Tip("telephone","请填写联系人电话");
                return false;
            }
            
            if ('' == $.trim($('#province10').val())) {
                Tip("province10","请填写目标安装地址省");
                return false;
            }
            if ('' == $.trim($('#district10').val())) {
                Tip("district10","请填写目标安装地址市");
                return false;
            }
            if ('' == $.trim($('#city10').val())) {
                Tip("city10","请填写目标安装地址区");
                return false;
            }
            if ('' == $.trim($('#province4').val())) {
                Tip("province4","请填写目标安装地址详细地址");
                return false;
            }
            if ('' == $.trim($('#product_categories').val())) {
                Tip("product_categories","请填写商品大类");
                return false;
            }
            if ('' == $.trim($('#product_categories1').val())) {
                Tip("product_categories1","请填写服务小类");
                return false;
            }
            if ('' == $.trim($('#brand').val())) {
                Tip("brand","请填写品牌");
                return false;
            }
            var zhuangtai= $("#pre_trans").prop("checked");
            if(zhuangtai){
                if ('' == $.trim($('#province').val())) {
                    Tip("province","请填写提货地址省");
                    return false;
                }
                if ('' == $.trim($('#city').val())) {
                    Tip("city","请填写提货地址市");
                    return false;
                }
                if ('' == $.trim($('#district').val())) {
                    Tip("district","请填写提货地址区");
                    return false;
                }
                if ('' == $.trim($('#dizhi').val())) {
                    Tip("dizhi","请填写提货地址详细");
                    return false;
                }
            }
            var zhuangtai= $("#pre_survey").prop("checked");
            if(zhuangtai){
                if ('' == $.trim($('#there_is_a_pre_survey').val())) {
                    Tip("there_is_a_pre_survey","请填写勘测单号");
                    return false;
                }
            }
            if ('' == $.trim($('#lse').val())) {
                Tip("less-l-carload_freight","请选择物流提货");
                return false;
            }
            if ('' == $.trim($('#sse').val())) {
                Tip("s_shi","请选择是否需要师傅自带板车");
                return false;
            }
            if ('' == $.trim($('#yse').val())) {
                Tip("y_shi","请选择是否需要师傅代缴工程押金");
                return false;
            }
            if ('' == $.trim($('#ase').val())) {
                Tip("Turnkey_mode","请选择安装模式");
                return false;
            }
            if ('' == $.trim($('#Up').val())) {
                msg("请选择安装进度计划表",2)
                return false;
            }
            if ('' == $.trim($('#drawings').val())) {
                msg("请选择安装图纸",2)
                return false;
            }
            if ('' == $.trim($('#check_list').val())) {
                msg("请选择安装验收单",2)
                return false;
            }
           
            var m= $("#ds-s").prop("checked");
            if(m){
                if ('' == $.trim($('#year_service_ordere_pwd').val())) {
                    Tip("year_service_ordere_pwd","请填写月结客户密码");
                    return false;
                }

            }


            }
            function complete(data){
                var ds_types=$("#ds_worker_type").val();
                if(ds_types==2){
                    layer.msg('您是师傅.不能下单');
                    return false;
                }
                var jump=null;
                if($("#ds-s").prop("checked")){

                    if($("#year_service_ordere_pwd").val()===""){
                        layer.tips("月结客户密码不能为空", '#year_service_ordere_pwd',{ icon: 2, time: 1500, shade: 0.1 ,tips:[1,"#ff5200"],shade:0});
                        $("#year_service_ordere_pwd").focus();
                        return false;
                    }
                }
                if(data.code===-1){
                    layer.confirm('你还未登录,请先登录', {
                        btn: ['登录','在看看'] //按钮
                    }, function(){
                        location.href="__PUBLIC__auth";
                        layer.closeAll()
                    }, function(){

                    });
                }else if(data.code===1){
                    layer.msg('下单成功',{icon:1,time:1500,shade: 0.1}, function(index){
                        layer.close(index);
                    });
                    var jump=data.src;
                    if(data.step_type==2){
                        window.location.href="__PUBLIC__choose_wid/"+jump+"/wid/0";
                    }else{
                        if($("#ds-s").prop("checked")){
                            window.location.href = "__PUBLIC__month_order/";
                        }else{

                            window.location.href = "__PUBLIC__install_jilt_single/" + jump;
                        }
                    }
                }else if(data.code===0){
                    layer.msg('你还不是月结客户',{icon:2,time:1500,shade: 0.1}, function(index){
                        layer.close(index);
                    });
                }else if(data.code===3){
                    layer.msg('月结密码错误',{icon:2,time:1500,shade: 0.1}, function(index){
                        layer.close(index);
                    });
                }
            }
        });

        var tupianshanchuan=function () {
            var uploader = WebUploader.create({
                auto: true,// 选完文件后，是否自动上传。
                swf: '__PUBLIC__static/admin/webupload/Uploader.swf',// swf文件路径
                server: "{:url('__PUBLIC__/admin/Uploads/dsupload')}",// 文件接收服务端。
                duplicate :true,// 重复上传图片，true为可重复false为不可重复
                pick: '#imgPicker',// 选择文件的按钮。可选。
                accept: {
                    title: 'Images',
                    extensions: '',
                    mimeTypes: ''
                },
                'onUploadSuccess': function(file, data, response) {
                    $("#Up").val(data._raw);
                    layer.closeAll();
                    layer.msg("上传成功",{ icon: 1, time: 1500, shade: 0 })
                }
            });
            var uploader1= WebUploader.create({
                auto: true,// 选完文件后，是否自动上传。
                swf: '__PUBLIC__static/admin/webupload/Uploader.swf',// swf文件路径
                server: "{:url('__PUBLIC__/admin/Uploads/dsupload')}",// 文件接收服务端。
                duplicate :true,// 重复上传图片，true为可重复false为不可重复
                pick: '#imgPicker1',// 选择文件的按钮。可选。
                accept: {
                    title: 'Images',
                    extensions: 'gif,jpg,jpeg,bmp,png',
                    mimeTypes: 'image/jpg,image/jpeg,image/png'
                },
                'onUploadSuccess': function(file, data, response) {
                    $("#drawings").val(data._raw);
                    layer.closeAll();
                    $("#img_data1").attr('src', '__DsQINiu__' + data._raw).show();
                    layer.msg("上传成功",{ icon: 1, time: 1500, shade: 0 })
                }
            });
            var uploader2 = WebUploader.create({
                auto: true,// 选完文件后，是否自动上传。
                swf: '__PUBLIC__static/admin/webupload/Uploader.swf',// swf文件路径
                server: "{:url('__PUBLIC__/admin/Uploads/dsupload')}",// 文件接收服务端。
                duplicate :true,// 重复上传图片，true为可重复false为不可重复
                pick: '#imgPicker2',// 选择文件的按钮。可选。
                accept: {
                    title: 'Images',
                    extensions: 'gif,jpg,jpeg,bmp,png',
                    mimeTypes: 'image/jpg,image/jpeg,image/png'
                },
                'onUploadSuccess': function(file, data, response) {
                    $("#check_list").val(data._raw);
                    layer.closeAll();
                    $("#img_data2").attr('src', '__DsQINiu__' + data._raw).show();
                    layer.msg("上传成功",{ icon: 1, time: 1500, shade: 0 })
                }
            });
            var uploader = WebUploader.create({
                auto: true,// 选完文件后，是否自动上传。
                swf: '__PUBLIC__static/admin/webupload/Uploader.swf',// swf文件路径
                server: "{:url('__PUBLIC__/admin/Uploads/dsupload')}",// 文件接收服务端。
                duplicate :true,// 重复上传图片，true为可重复false为不可重复
                pick: '#imgPickers',// 选择文件的按钮。可选。
                accept: {
                    title: 'Images',
                    extensions: 'gif,jpg,jpeg,bmp,png',
                    mimeTypes: 'image/jpg,image/jpeg,image/png'
                },
                'onUploadSuccess': function(file, data, response) {
                    $("#data_photos").val(data._raw);
                    $("#img_datas").attr('src', '__DsQINiu__' + data._raw).show();
                }
            });
        }
        tupianshanchuan();
        var elelementclick=function () {
            $(".The-test-panel-body").on("change","#product_categories",function () {
                var va=$(this).val();
                var his=$("#product_categories1");

                $.getJSON("__PUBLIC__orders/twostclass",{bigname:va},function(json){
                    //清空原有的选项
                    his.html("");
                    $.each(json,function(index,array){


                        var option = "<option value='"+array['id']+"'>"+array['name']+"</option>";
                        his.append(option);

                    });
                });
            });
            $(".js-example-tags").select2({tags: true});
            $(".select2-container").css("width", "100%");

            $(".select2-selection").css("border","none")
            $("#select2-brand-container").addClass("form-control").css({
                lineHeight:"22px"
            })
            $(".upload_module").on("click","a",function (e) {
                e.preventDefault();
                var this_=$(this);
                this_.css("border-color","red");
                this_.parent().siblings("input[type='hidden']").val(this_.attr('num'));
                this_.parent().siblings("div").find("a").css("border-color","#00a0e9");
                var layer=layui.layer;
                var hr=$(this).attr('href');
                if(this_.text()=="上传计划表图"){
                    $("#de").height("150px");
                    layer.open({
                        type:1,
                        area:["300px","300px"],
                        content:$("#de"),
                        time:"20000",
                        cancel:function (idnex) {
                            $("#de").height("0px");
                        }
                    });
                }else if(this_.text()=="上传图纸图"){
                    $("#de1").height("150px");
                    layer.open({
                        type:1,
                        area:["300px","300px"],
                        content:$("#de1"),
                        time:"20000",
                        cancel:function (idnex) {
                            $("#de1").height("0px");
                        }
                    });
                }else if(this_.text()=="上传验收单图"){
                    $("#de2").height("150px");
                    layer.open({
                        type:1,
                        area:["300px","300px"],
                        content:$("#de2"),
                        time:"20000",
                        cancel:function (idnex) {
                            $("#de2").height("0px");
                        }
                    });
                }


            });
            var layer=layui.layer;
            $("#yezhuxieyi").click(function () {
                var   layer=layui.layer;parent.layer.open({type:2, title:"业主协议", btn:['我同意',"我再看看"], content:" __PUBLIC__yezhuxieyi", area:["80%","80%"], yes:function(index,layero){

                    $("#agreement").prop("checked",'true');layer.close(index);$("#xiandan").prop("disabled",false);$("#quick_consulting").prop("disabled",false);
                },
                    btn2:function(index,layero){
                        $("#agreement").prop("checked",false);layer.close(index);$("#xiandan").prop("disabled",true);$("#quick_consulting").prop("disabled",true);
                    }
                })
            })
            $("#xiandan").click(function () {
                $("#step_type").val(1);
                $("#judge").val(1);
            });
            $("#quick_consulting").click(function () {
                $("#step_type").val(2);
            })
            var nua=1;
            var m=0;
            $("#pre_trans").change(function () {
                if ($(this).prop("checked")){
                    $(this).val(1);
                    $(this).parent().parent().siblings().removeClass("hidden");

                    $(this).parent().parent().siblings().find("select").prop("disabled",false);
                    $(this).parent().parent().siblings().find("input").prop("disabled",false);
                    nua=1;
                } else {
                    $(this).parent().parent().siblings().addClass("hidden");
                    nua=0;
                    $(this).parent().parent().siblings().find("select").prop("disabled",true);
                    $(this).parent().parent().siblings().find("input").prop("disabled",true);
                    $(this).val(0)
                }
            })
            $("#pre_survey").change(function () {
                if ($(this).prop("checked")){
                    $(this).val(1)
                    $(this).parent().parent().siblings().removeClass("hidden");
                    $(this).parent().parent().siblings().find("input").prop("disabled",false);
                    m=1;
                } else {
                    $(this).parent().parent().siblings().addClass("hidden");
                    $(this).parent().parent().siblings().find("input").prop("disabled",true);
                    $(this).parent().parent().siblings().find("input").val("")
                    m=0;
                    $(this).val(0)
                }
            });

            $("#xiandan").click(function () {
                $("#ds-sub").val(3);
            })
            $("#quick_consulting").click(function () {
                $("#ds-sub").val(4);
            })
            var s;
            $("#monthly_service").change(function () {
                if ($(this).prop("checked")){
                    $(this).val(1)
                    $("#year_service_ordere_pwd").prop("disabled",false);
                    s=1;
                } else {
                    $("#year_service_ordere_pwd").prop("disabled",true);
                    s=0;
                    $(this).val(0)
                }
            })
//同意勾选
            $("#agreement").click(function () {
                if ($(this).prop("checked")) {
                    $("#xiandan").removeClass("disabled");
                    $("#quick_consulting").removeClass("disabled");
                } else {
                    $("#xiandan").addClass("disabled");
                    $("#quick_consulting").addClass("disabled");
                }
            });
//        月结勾选
            $("#ds-s").change(function () {
                if ($(this).prop("checked") === true) {
                    $("#year_service_ordere_pwd").css("opacity", '1');$("#quick_consulting").css("opacity", "0");} else {$("#year_service_ordere_pwd").css("opacity", '0');$("#quick_consulting").css("opacity", "1");
                }
            });
            var na=true;
            $(".k").on("change","input[type='radio']",function () {

                $(this).parent().parent().siblings("input[type='hidden']").val($(this).val());
                if($(this).attr("title")==="全包模式"){
                    $(".B").hide();
                    $(".B").find("input").val("");
                    $(".B").find("input").prop("disabled",true);
                    na=false;
                }else if($(this).attr("title")==="协助模式"){
                    $(".B").show();
                    $(".B").find("input").val("");
                    $(".B").find("input").prop("disabled",false);
                    na=true;
                }
            });
            //判断是否需要核单
            $('#nuclear_list_in_advance').click(function () {
                if ($(this).prop("checked") === true) {
                    $('#ds_hedan').val(1);
                } else {
                    $('#ds_hedan').val(0);
                }
            })
        }
        elelementclick()
    })
</script>
